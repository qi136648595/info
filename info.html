<!DOCTYPE html>
<html lang="en" class="">
	<!-- BEGIN HEAD -->
	<head>
		<meta charset="utf-8"/>
		<title>个人信息</title>
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta content="width=device-width, initial-scale=1" name="viewport"/>
		<meta content="" name="Metronic Launcher"/>
		<meta content="" name="KeenThemes"/>
		<!--End of Zopim Live Chat Script-->
		<link href="css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
		<link href="css/components.min.css" rel="stylesheet" type="text/css"/>
        <link href="css/font-awesome.css" rel="stylesheet" type="text/css"/>
        <link href="css/font-awesome.min.css" rel="stylesheet" type="text/css"/>
        <link href="css/profile.min.css" rel="stylesheet" type="text/css"/>
        <link href="css/layout.min.css" rel="stylesheet" type="text/css"/>
        <link href="css/_all.css" rel="stylesheet" type="text/css"/>
        <link href="css/plugins.min.css" rel="stylesheet" type="text/css"/>
        <link href="style/index.css" rel="stylesheet" type="text/css"/>
		<!-- END GLOBAL MANDATORY STYLES -->
		<!-- BEGIN THEME STYLES - - >
		<link href="_start/style.css" rel="stylesheet" type="text/css"/>
		< ! - END THEME STYLES -->
	</head>
	<!-- END HEAD -->
	<!-- BEGIN BODY -->
<body class="page-header-fixed page-sidebar-closed-hide-logo page-container-bg-solid page-content-white page-sidebar-closed" style="background:#ccc;">

	<div class="page-content-wrapper">
	<div class="page-content" style="padding-top:10px!important">
		<div class="row">
			<div class="col-md-12">
				<div class="profile-sidebar">
					
					<div class="portlet light profile-sidebar-portlet">
                        <!-- SIDEBAR USERPIC -->
                        <div class="profile-userpic">
                            <img src="img/profile_user.jpg" class="img-responsive" alt=""> </div>
                        <!-- END SIDEBAR USERPIC -->
                        <!-- SIDEBAR USER TITLE -->
                        <div class="profile-usertitle">
                            <div class="profile-usertitle-name">马库斯.道尔 </div>
                            <div class="profile-usertitle-job display-hide"> 是否是公司员工</div>
                        </div>
                        <!-- END SIDEBAR USER TITLE -->
                       <hr>               	
                                                
                                                    
                    	 <div class="portlet light my_portlet" style="padding-top:0;">
                                            
                                            <div class="portlet-body">
                                                <div class="tab-content" >

                                                   <!-- 修改个人信息 -->
                                                     <div class="tab-pane my_user">
                                                        <h3 class=" text-center ">修改个人信息</h3>
                                                        <form role="form" id="my_form1" name="my_form1" action="#">
                                                            <div class="form-group">
                                                                <label class="control-label">姓名</label>
                                                                <input type="text" placeholder="姓名" name="name" id="name" class="form-control"> 
                                                            	<div class="my_ts">请输入姓名</div>
                                                            </div>
                                                            <div class="form-group">
                                                                <label class="control-label">手机号码</label>
                                                                <input type="text" placeholder="手机号码" name="tel" id="tel" class="form-control"><span class="my_yz disabled" onclick="my_yz()">获取验证码</span>
                                                            	<div class="my_ts">请输入手机号码</div>
                                                            </div>
                                                            <div class="form-group">
                                                                <label class="control-label">验证码</label>
                                                                <input type="text" placeholder="验证码" name="tel_yz" id="tel_yz" class="form-control"> 
                                                            	<div class="my_ts">请输入验证码</div>
                                                            </div>
                                                           <div class="form-group">
                                                                <label class="control-label">身份证号码</label>
                                                                <input type="text" placeholder="身份证号码" name="card_id" id="card_id" class="form-control"> 
                                                           		<div class="my_ts">请输入身份证号码</div>
                                                           </div>
                                                            <div class="margiv-top-10">
                                                                <a href="javascript:sub_1();" class="btn green my_but">提交</a>
                                                                <input type="reset" class="btn default" value="重置">
                                                            </div>
                                                        </form>
                                                    </div>
                                                    <!--end 修改个人信息 -->

                                                     <!--是公司员工验证信息 -->
                                                     <div class="tab-pane my_comp ">
                                                        <h3 class=" text-center margin-top-10">请验证您的信息</h3>
														<hr>
                                                        <form role="form" id="my_form2" name="my_form2" action="#">
                                                            <div class="form-group">
                                                                <label class="control-label">姓名</label>
                                                                <input type="text" placeholder="姓名" name="comp_name" id="comp_name" class="form-control"> 
                                                            	<div class="my_ts">请输入姓名</div>
                                                            </div>
                                                           
                                                            <div class="form-group">
                                                                <label class="control-label">密码</label>
                                                                <input type="password" placeholder="密码" name="comp_passw" id="comp_passw" class="form-control"> 
                                                            	<div class="my_ts">请输入密码</div>
                                                            </div>
                                                           
                                                            <div class="margiv-top-10">
                                                                <a href="javascript:sub_3();" class="btn green">提交</a>
                                                                <input type="reset" class="btn default" value="重置">
                                                            </div>
                                                        </form>
                                                    </div>
                                                     <!-- END 是公司员工验证信息 -->
													
                                                    <!-- 提示是否为公司人员 -->
                                                     <div class="tab-pane text-center my_neibu">
                                                        <div class="caption caption-md margin-bottom-30">
                                                             <h3 class=" text-center">您是公司内部人员吗？</h3>
                                                        </div>
                                                        
                                                            <a href='javascript:my_dispaly_ov(".my_comp",".my_user",".my_error",".my_neibu","",".portlet.light");' class="btn green">是</a>
                                                            
                                                            <a href='javascript:my_dispaly_ov(".my_user",".my_comp",".my_error",".my_neibu",".my_succ",".portlet.light");' class="btn green">否</a>
                                                    </div>
                                                    <!--end  提示是否为公司人员-->
                                                    
                                                    <!-- 修改成功 -->
                                                     <div class="tab-pane text-center my_succ">
                                                        <div class="caption caption-md margin-bottom-30">
                                                             <h3 class=" text-center">恭喜！！！已修改成功</h3>
                                                        </div>
                                                            <a href='javascript:my_dispaly_ov(".my_user",".my_comp",".my_error",".my_neibu",".my_succ",".portlet.light");' class="btn green">确定</a>
                                                    </div>
                                                    <!--end 修改成功 -->
                                                    <!-- 员工密码错误 -->
                                                     <div class="tab-pane text-center my_error">
                                                        <div class="caption caption-md margin-bottom-30">
                                                             <h3 class=" text-center">密码错误</h3>
                                                        </div>
                                                            <a href='javascript:my_dispaly_ov(".my_comp",".my_user",".my_error",".my_neibu");' class="btn green">确定</a>
                                                           
                                                    </div>
                                                    <!--end 员工密码错误 -->
                                                </div>
                                            </div>
                         </div>               
                    </div>
				</div>
			</div>
		</div>
		</div>
	</div>

<script src="js/jquery.min.js" type="text/javascript"></script>
<script src="js/form_yz.js" type="text/javascript"></script>
<script type="text/javascript">
 var comp_name=false,comp_passw=false,name=false,tel=false,card_id=false,tel_yz=false,gg=false,hh=false,ii=false,jj=false,kk=false;
$(function(){
    	var scrollheiht=window.document.body.scrollHeight;
    	var odivheight=$(".profile-sidebar").innerHeight();
    	$(".portlet.light").css("height",scrollheiht-50)
    	
//  	var scrollheiht=window.document.body.scrollHeight;
//  	$(".profile-sidebar-portlet").css("height",scrollheiht-20)
//  	$(".page-content").css("height",scrollheiht)
    	//外部人员修改信息
    	$("#name").blur(function(){//判断用户是否为空
    			name=obj_yz.name("#name")
    			console.log(name)
		});
		$("#tel").blur(function(){//验证电话
	    			tel=obj_yz.tel("#tel")
	    			console.log(tel)
		});
		$("#tel_yz").blur(function(){//验证验证码
    			tel_yz=iis_null("#tel_yz");
		});
    	$("#card_id").blur(function(){//验证身份证号
    			card_id=obj_yz.card_id("#card_id")
    			console.log(card_id)
				
		});
		
    	//公司内部人员
    	$("#comp_name").blur(function(){//判断用户是否为空
    			comp_name=iis_null("#comp_name")
				
		});
		$("#comp_passw").blur(function(){//判断密码是否为空
	    			comp_passw=iis_null("#comp_passw")
		});
    $.ajax({//判断是否第一次修改个人信息
    		type:"POST",
    		url:"json/my_comp.json",
    		async:true,
			dataType:"json",
			success:function(data){
				$.each(data, function(i,item) {
					var aa=item.my_comp;//是否第一次修改个人信息，如果是 提示是否为公司内部人员。
					if(aa==0){//第一次修改个人信息
						my_dispaly(".my_neibu",".my_user",".my_error",".my_comp")
					}
					if(aa==1){//是公司内部人员
							my_dispaly(".my_comp",".my_user",".my_error",".my_neibu","",".portlet.light")
					}
					if(aa==2){//是客户
						my_dispaly(".my_user",".my_comp",".my_error",".my_neibu","",".portlet.light")
					}
				});
			},
			error:function(){
				obj_yz.myerror()
			}
    });
})

function sub_1(){//验证用户信息   名字  手机号  身份证等
    	if(name&&tel&card_id&&tel_yz){
    		$.ajax({
				type:"POST",
				url:"json/my_comp.json",
				dataType:"json",
				success:function(data){		
					console.log("请写入到数据库中")
					$(".my_user").css("display","none")
    				$(".my_succ").css("display","block")
					
				}
			});
    	}else{
    		alert("请填写完成！")
    	}
}
function sub_3(){//是公司员工    判断员工输入的密码是否正确 好调取很多数据
	if(comp_name&&comp_passw){
		//验证员工的用户和密码和数据库中的是否一样
		$.ajax({
				type:"POST",
				url:"json/my_comp.json",//获取用户名和密码 提交给java判断是否为公司人员
				dataType:"json",
				success:function(data){			
			 		$.each(data,function(i,item){  
                        var content=item.my_comp;
                        console.log(content)
                        if(content==1){
                        	//和数据库中一样    是公司的员工      提示欢迎   在获取用户的信息
	                     	$("#name").val(item.name)
                        	$("#tel").val(item.tel)
                        	$("#card_id").val(item.card_id)
                        	$(".my_comp").css("display","none")
    						$(".my_succ").css("display","block")
    						
                        }else{
                        	//员工输入错误   请重新输入
                        	$(".my_comp").css("display","none")
    						$(".my_error").css("display","block")
                        }
             		})
				}
			});
	}else{
		alert("请填写表单")
	}
}
var otime=true;//
var i=60;//获取验证码倒计时
var time;//计时器
function my_yz(){//手机号码验证     返回验证码
	if(otime){
		$.ajax({
			type:"POST",
			url:"json/tel_yz.json",
			cache:false,
			dataType:"json",
			success:function(data){
				clearInterval(time)
				$(".my_yz").css("background-color","#ccc")
				$(".my_yz").text("60")
					time=setInterval(daojishi,1000);
				 $.each(data,function(i,item){  
	                        var content=item.tel_yz;
	                        $("#tel_yz").val(content);
	                        $("#tel_yz").siblings("div").css("display","none");
	             })
			
			}
		});
		otime=false;
		return false
	}
	
}
function daojishi(){
		if(i>0){var mun=$(".my_yz").text(i=i-1);
		}else{
			clearInterval(time)
			otime=true;
			$(".my_yz").text("获取验证码")
			$(".my_yz").css("background-color","#19a612")
		}
}
function my_dispaly_ov(odiv,odiv1,odiv2,odiv3,odiv4,odivdisp){//个人信息页面
	clearInterval(time)
	$(".my_yz").text("获取验证码")
	$(".my_yz").css("background-color","#19a612")
	
	$(odiv).css("display","block")
	$(odiv1).css("display","none")
	$(odiv2).css("display","none")
	$(odiv3).css("display","none")
	$(odiv4).css("display","none")
	$(odivdisp).css("height","auto")
}

</script>


</body>
</html>